{{- /* Comments area start */ -}}
{{- /* to add comments read => https://gohugo.io/content-management/comments/ */ -}}
{{- /* Comments area end */ -}}
<div id="giscus-container"></div>
<script>
    (function() {
        const container = document.getElementById("giscus-container");
        if (!container) return;

        const script = document.createElement("script");
        script.src = "https://giscus.app/client.js";
        script.setAttribute("data-repo", "Xinrea/Xinrea.github.io");
        script.setAttribute("data-repo-id", "R_kgDOHCi93A");
        script.setAttribute("data-category", "Announcements");
        script.setAttribute("data-category-id", "DIC_kwDOHCi93M4CqIPv");
        script.setAttribute("data-mapping", "pathname");
        script.setAttribute("data-strict", "0");
        script.setAttribute("data-reactions-enabled", "1");
        script.setAttribute("data-emit-metadata", "0");
        script.setAttribute("data-input-position", "top");
        script.setAttribute("data-lang", "zh-CN");
        script.setAttribute("data-loading", "lazy");
        script.setAttribute("crossorigin", "anonymous");
        script.async = true;

        // Check current theme
        const isDark = document.body.classList.contains('dark');
        const theme = isDark ? 'dark' : 'light';
        script.setAttribute("data-theme", theme);

        container.appendChild(script);

        // Listen for theme toggle
        const toggle = document.getElementById('theme-toggle');
        if (toggle) {
            toggle.addEventListener('click', () => {
                setTimeout(() => {
                    const isDarkNow = document.body.classList.contains('dark');
                    const newTheme = isDarkNow ? 'dark' : 'light';
                    
                    const iframe = document.querySelector('iframe.giscus-frame');
                    if (iframe) {
                        iframe.contentWindow.postMessage({
                            giscus: {
                                setConfig: {
                                    theme: newTheme
                                }
                            }
                        }, 'https://giscus.app');
                    }
                }, 200); // Delay to wait for class change
            });
        }
    })();
</script>

